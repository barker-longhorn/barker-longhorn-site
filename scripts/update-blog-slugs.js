const fs = require("fs");
const path = require("path");

const projectRoot = path.resolve(__dirname, "..");
const mdDir = path.join(projectRoot, "public", "blog", "md");
const outputFile = path.join(projectRoot, "src", "content", "blog", "postSlugs.js");

if (!fs.existsSync(mdDir)) {
  console.error(`Missing folder: ${mdDir}`);
  process.exit(1);
}

const slugs = fs
  .readdirSync(mdDir)
  .filter((file) => file.endsWith(".txt"))
  .map((file) => file.replace(/\.txt$/, ""))
  .sort();

const content = `// Auto-generated by scripts/update-blog-slugs.js\nexport const POST_SLUGS = ${JSON.stringify(slugs, null, 2)};\n`;

fs.writeFileSync(outputFile, content, "utf8");
console.log(`Wrote ${slugs.length} slugs to ${outputFile}`);
